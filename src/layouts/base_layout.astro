---
const SITE_URL = "https://daipan.art";

const {
    title = "Dai Pan",
    description = "Dai Pan — image-based work across photography, printmaking, and conceptual design.",
    canonical = SITE_URL,
    active = "", // "works" | "about" | "contact"
    homePage = false,
    ogImage = undefined as string | undefined,
    ogType = "website" as "website" | "article",
    breadcrumbs = undefined as { name: string; url: string }[] | undefined,
} = Astro.props;

const absoluteOgImage = ogImage ? (ogImage.startsWith("http") ? ogImage : `${SITE_URL}${ogImage}`) : undefined;

const personSchema = {
    "@context": "https://schema.org",
    "@type": "Person",
    name: "Dai Pan",
    alternateName: [
        "Pan Dai",
        "潘岱",
        "daipan",
        "pan dai",
        "dai pan",
    ],
    url: SITE_URL,
    jobTitle: "Artist / Designer",
    knowsAbout: [
        "photography",
        "printmaking",
        "conceptual design",
        "visual art",
        "web development",
        "writing",
        "摄影",
        "版画",
        "概念设计",
        "视觉艺术",
        "网页开发",
        "写作",
    ],
    sameAs: [
        "https://www.instagram.com/jumpingchick666",
        "https://sva.design/students/dai-pan",
        "https://www.daiportfolio.com/",
        "https://www.linkedin.com/in/daipanportfolio/",
        "https://www.instagram.com/p/DT2UEHQCJiD/",
    ],
};

const websiteSchema = {
    "@context": "https://schema.org",
    "@type": "WebSite",
    name: "Dai Pan",
    alternateName: ["潘岱", "Pan Dai", "daipan.art"],
    url: SITE_URL,
    description: "Dai Pan — image-based work across photography, printmaking, and conceptual design. Artist and designer, Brisbane.",
    author: { "@type": "Person", "name": "Dai Pan", "url": SITE_URL },
    inLanguage: ["en"],
};

const breadcrumbSchema = breadcrumbs?.length
    ? {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        itemListElement: breadcrumbs.map((item, i) => ({
            "@type": "ListItem",
            position: i + 1,
            name: item.name,
            item: item.url,
        })),
    }
    : null;

const nav = [
    { href: "/quite_off", label: "Quite Off", key: "quite_off"},
    { href: "/the_threes", label: "The Threes", key: "the_threes"},
    { href: "/gallery_design", label: "Monolith for Light", key: "gallery_design"},
    { href: "/reframed_still", label: "Reframed Still", key: "reframed_still"},
    { href: "/closing_time", label: "Closing Time", key: "closing_time"},
    { href: "/masks", label: "Masks", key: "masks"},
    { href: "/about", label: "About", key: "about" },
    { href: "/contact", label: "Contact", key: "contact" },
];

const projectKeys = ["quite_off", "the_threes", "gallery_design", "reframed_still", "closing_time", "masks"];
const portfolioSchema = homePage
    ? {
        "@context": "https://schema.org",
        "@type": "ItemList",
        name: "Dai Pan — Works",
        description: "Image-based work across photography, printmaking, and conceptual design.",
        itemListElement: nav
            .filter((n) => projectKeys.includes(n.key))
            .map((n, i) => ({
                "@type": "ListItem",
                position: i + 1,
                item: {
                    "@type": "CreativeWork",
                    name: n.label,
                    url: `${SITE_URL}${n.href}`,
                    author: { "@type": "Person", name: "Dai Pan" },
                },
            })),
    }
    : null;
---

<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>{title}</title>

        <meta name="description" content={description} />
        <meta name="robots" content="index, follow" />
        <meta name="author" content="Dai Pan" />
        <meta name="keywords" content="Dai Pan, Pan Dai, 潘岱, daipan, pan dai, dai pan, artist, designer, photographer, printmaker, writer, web developer, conceptual designer, visual artist, 艺术家, 设计师, 摄影师, 版画, 作家, 网页开发, 概念设计, 视觉艺术, 摄影, Brisbane, Australia, 布里斯班, 澳大利亚, portfolio, photography, printmaking, conceptual design, Monolith for Light, Quite Off, The Threes, Reframed Still, Closing Time, Masks" />
        <link rel="canonical" href={canonical} />
        <!-- 百度/360 站长验证：在各自站长平台获取验证码后，取消注释并填入 content -->
        <!-- <meta name="baidu-site-verification" content="YOUR_BAIDU_CODE" /> -->
        <!-- <meta name="360-site-verification" content="YOUR_360_CODE" /> -->

        <!-- Open Graph -->
        <meta property="og:title" content={title} />
        <meta property="og:description" content={description} />
        <meta property="og:type" content={ogType} />
        <meta property="og:url" content={canonical} />
        {absoluteOgImage && <meta property="og:image" content={absoluteOgImage} />}

        <!-- Twitter Card -->
        <meta name="twitter:card" content={absoluteOgImage ? "summary_large_image" : "summary"} />
        <meta name="twitter:title" content={title} />
        <meta name="twitter:description" content={description} />
        {absoluteOgImage && <meta name="twitter:image" content={absoluteOgImage} />}

        <!-- GEO -->
        <meta name="geo.region" content="AU" />
        <meta name="geo.placename" content="Brisbane" />

        <!-- Preconnect for fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600&family=Coustard:wght@400;900&family=Oldenburg&display=swap"
            rel="stylesheet"
        />

        <!-- Structured Data: Person, WebSite, BreadcrumbList -->
        <script type="application/ld+json" set:html={JSON.stringify(personSchema)} />
        <script type="application/ld+json" set:html={JSON.stringify(websiteSchema)} />
        {breadcrumbSchema && <script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />}
        {portfolioSchema && <script type="application/ld+json" set:html={JSON.stringify(portfolioSchema)} />}

        <slot name="head" />
    </head>

    <body>
        <div class="shell">
            <aside class="sidebar">
                <div class="brand">
                    <a href="/" class="brand_name">Dai Pan</a>
                </div>

                <nav class="menu">
                    {
                        nav.map((item) => (
                            <a
                                class={`menu_link ${active === item.key ? "is_active" : ""} ${item.key === "about" ? "menu_link--after_projects" : ""}`}
                                href={item.href}
                                data-project={item.key}>
                                {item.label}
                            </a>
                        ))
                    }
                </nav>

                <!-- Social icons (keep minimal) -->
                <div class="social">
                    <a
                        class="icon_link"
                        href="mailto:dpan53853@gmail.com"
                        aria-label="Email (Work)">
                        <svg
                            viewBox="0 0 24 24"
                            width="28"
                            height="28"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="1.6">
                            <path d="M4 6h16v12H4z"></path>
                            <path d="M4 7l8 6 8-6"></path>
                        </svg>
                    </a>

                    <a
                        class="icon_link"
                        href="https://www.instagram.com/jumpingchick666"
                        target="_blank"
                        rel="noopener noreferrer"
                        aria-label="Instagram">
                        <svg
                            viewBox="0 0 24 24"
                            width="32"
                            height="32"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="1.6">
                            <rect x="6" y="6" width="12" height="12" rx="3"
                            ></rect>
                            <path
                                d="M12 15.2a3.2 3.2 0 1 0 0-6.4 3.2 3.2 0 0 0 0 6.4z"
                            ></path>
                            <path d="M16.2 7.8h.01"></path>
                        </svg>
                    </a>
                </div>
            </aside>

            <main class:list={["content", { "content--home": homePage }]}>
                <slot />
            </main>
        </div>

        <style>
            :global(:root) {
                --body:
                    "Be Vietnam Pro", system-ui, -apple-system, Segoe UI,
                    Roboto, Helvetica, Arial;
                --heading:
                    "Coustard", ui-serif, Georgia, "Times New Roman", Times,
                    serif;
                --display: "Oldenburg", serif;

                --bg: #ffffff;
                --text: #111111;
                --muted: #6a6a6a;
                --line: #ececec;
                --max: 900px;
                --top_align: 64px;
            }

            :global(body) {
                margin: 0;
                background: var(--bg);
                color: var(--text);
                font-family: var(--body);
                line-height: 1.6;
                font-size: 18px;
                letter-spacing: 0.1px;
            }

            :global(a) {
                color: inherit;
                text-decoration: none;
            }

            /* subtle hover, barely visible */
            :global(a:hover) {
                text-decoration: underline;
                text-underline-offset: 3px;
            }

            .shell {
                min-height: 100vh;
                display: grid;
                grid-template-columns: 280px 1fr;
            }

            .sidebar {
                padding: 48px 48px;
                border-right: 1px solid var(--line);
                position: sticky;
                top: 0;
                height: 100vh;
                box-sizing: border-box;
                display: flex;
                flex-direction: column;
                gap: 18px;
            }

            .brand_name {
                font-family: var(--display);
                font-weight: 400;
                letter-spacing: 0.06em;
                font-size: 30px;
            }

            .menu {
                display: grid;
                gap: 12px;
                margin-top: 10px;
            }

            .menu_link {
                font-size: 18px;
                color: var(--muted);
                width: fit-content;
                transition: color 0.44s cubic-bezier(0.25, 0.1, 0.25, 1), font-weight 0.4s cubic-bezier(0.25, 0.1, 0.25, 1);
            }

            .menu_link.is_active {
                color: var(--text);
                text-decoration: underline;
                text-underline-offset: 3px;
            }

            .menu_link--after_projects {
                margin-top: 1.5em;
            }

            .social {
                margin-top: auto;
                display: flex;
                gap: 12px;
                color: var(--muted);
            }

            .icon_link {
                display: inline-flex;
                align-items: center;
                justify-content: center;
                width: 30px;
                height: 30px;
                border-radius: 999px;
            }

            .icon_link:hover {
                text-decoration: none;
                outline: 1px solid var(--line);
                color: var(--text);
            }

            .content {
                padding: 64px 64px 72px;
                box-sizing: border-box;
            }

            .content > :global(*) {
                max-width: var(--max);
            }

            :global(h1) {
                font-family: var(--display);
                margin: 0 0 16px;
                font-size: 30px;
                font-weight: 600;
                letter-spacing: 0.2px;
            }

            :global(h2) {
                font-family: var(--heading);
                margin: 30px 0 10px;
                font-size: 15px;
                font-weight: 600;
                letter-spacing: 0.05em;
                text-transform: uppercase;
                color: var(--text);
            }

            :global(p) {
                margin: 0 0 14px;
            }

            @media (max-width: 820px) {
                .shell {
                    grid-template-columns: 1fr;
                }
                .sidebar {
                    position: relative;
                    height: auto;
                    border-right: none;
                    border-bottom: 1px solid var(--line);
                }
            }

            .shell {
                display: grid;
                grid-template-columns: 320px 1fr;
                min-height: 100vh;
            }

            .main {
                min-width: 0; /* 很重要：防止图片/长文本把布局撑爆 */
            }

            .content {
                /* 关键：在右侧 1fr 区域里居中 */
                max-width: 980px; /* 你想要更窄就 900/920 */
                margin-inline: auto;
                padding-inline: clamp(28px, 4vw, 64px);
                padding-block: clamp(32px, 4vw, 72px);
            }

            .content--home {
                overflow: hidden;
                max-width: none;
                height: 100vh;
                display: flex;
                flex-direction: column;
            }
        </style>
    </body>
</html>
