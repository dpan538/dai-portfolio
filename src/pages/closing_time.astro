---
import BaseLayout from "../layouts/base_layout.astro";

const title = "Closing Time";
const description =
    "Closing Time — a single-piece 5-color photo lithography work created using CMYK and opaque white to simulate watercolor-like softness. Film photograph shot in Manhattan before closing hour.";

const imagePath = "/projects/closing_time/closing_time.jpg";
---

<BaseLayout title={title} description={description} canonical="https://daipan.art/closing_time" ogImage={imagePath} ogType="article" active="closing_time" breadcrumbs={[{ name: "Home", url: "https://daipan.art" }, { name: "Closing Time", url: "https://daipan.art/closing_time" }]}>

    <!-- ===== 页面主体（右侧内容区）===== -->
    <section class="ct">
        <!-- 首屏：只放图片 -->
        <div class="ct__hero">
            <figure class="ct__figure">
                <img
                    class="ct__img"
                    src={imagePath}
                    alt="Closing Time lithography artwork"
                />
            </figure>
        </div>

        <!-- 下滑后：文字信息 -->
        <div class="ct__content">
            <header class="ct__title-block">
                <h1>Closing Time</h1>
                <p class="ct__meta">
                    5-Color Photo Lithography — CMYK + Opaque White · Film
                    Photograph · Hand-Printed
                </p>
            </header>

            <div class="ct__description">
                <p>
                    A single-piece work exploring the boundary between
                    photographic clarity and painterly dissolution. Produced
                    through layered lithographic registration to simulate the
                    softness and translucency of watercolor.
                </p>

                <p>
                    Shot on film in Manhattan shortly before closing hour, the
                    image captures a suspended atmosphere where artificial
                    light, reflection, and surface texture merge into a quiet
                    field.
                </p>
            </div>
        </div>
    </section>

    <!-- Lightbox（与 masks 一致：lightbox 自身为 backdrop，hidden 控制显示） -->
    <div id="lightbox" class="lightbox hidden">
        <img id="lightbox-image" class="lightbox__img" src={imagePath} alt="Closing Time - Full View" />
        <button class="lightbox__close" aria-label="Close lightbox">
            <svg
                width="32"
                height="32"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2">
                <path d="M18 6L6 18M6 6l12 12"></path>
            </svg>
        </button>
    </div>

    <style>
        /* 关键：BaseLayout 的 .content > * 有 max-width: var(--max)，会约束 lightbox 宽度。需覆盖以便 lightbox 覆盖全视口 */
        :global(main.content > #lightbox) {
            max-width: none !important;
        }

        /* 页面容器 */
        .ct {
            width: 100%;
        }

        /* Hero：占满首屏并突破 BaseLayout 的 padding */
        .ct__hero {
            /* 用负 margin 抵消 BaseLayout 的 padding (64px top, 64px sides, 72px bottom) */
            margin: -72px -88px 0 -88px;

            /* 首屏高度 */
            height: 100dvh;

            /* 现在添加一致的内边距（使用 72px 与底部对齐） */
            padding: 72px;
            box-sizing: border-box;

            /* 居中图片 */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ct__figure {
            width: 100%;
            height: 100%;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* 关键：用“高度驱动”让图片尽可能大 */
        .ct__img {
            max-width: 100%;
            max-height: 100%;
            border: 1px solid var(--line);
            width: auto;
            height: auto;
            object-fit: contain; /* 保留纸边，不裁切 */
            display: block;
            cursor: zoom-in; /* 鼠标悬停显示放大图标 */
            transition: opacity 0.2s ease;
        }

        .ct__img:hover {
            opacity: 0.9;
        }

        /* 下滑后的正文 */
        .ct__content {
            max-width: 72ch; /* 控制阅读宽度 */
            margin: 0 auto;
            padding-top: 40px; /* 和 hero 拉开 */
            padding-bottom: 96px;
        }

        /* 标题区：做成明确的 block */
        .ct__title-block {
            margin-bottom: 28px; /* 让标题区和正文分开 */
            padding-bottom: 18px;
            border-bottom: 1px solid var(--line); /* 用你现有的线色变量 */
        }

        .ct__title-block h1 {
            font-size: 1.35rem;
            font-weight: 600;
            letter-spacing: 0.04em;
            line-height: 1.3;
        }

        .ct__meta {
            margin: 6px 0 0 0;
            font-size: 0.9rem;
            opacity: 0.7;
        }

        .ct__description {
            max-width: 70ch;
            margin-top: 14px;
        }

        .ct__description p {
            margin: 0 0 12px 0;
        }

        /* 响应式调整：在小屏幕上减少 padding */
        @media (max-width: 820px) {
            .ct__hero {
                margin: -32px -28px 0 -28px;
                padding: 32px;
            }
        }

        /* ===== Lightbox（与 masks 一致：fixed + inset:0 覆盖全视口，hidden 控制显示）===== */
        .lightbox {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.92);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 999;
            cursor: zoom-out;
        }

        .lightbox.hidden {
            display: none;
        }

        .lightbox__img {
            max-height: 90vh;
            max-width: 90vw;
            width: auto;
            height: auto;
            object-fit: contain;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            cursor: default;
        }

        .lightbox__close {
            position: absolute;
            top: 24px;
            right: 24px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s ease;
        }

        .lightbox__close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .lightbox__close svg {
            width: 24px;
            height: 24px;
        }
        
    </style>

    <script>
        // Lightbox（与 masks 一致：hidden 控制显示，点击 backdrop/ESC/按钮关闭，body 滚动锁定）
        const img = document.querySelector('.ct__img');
        const lightbox = document.getElementById('lightbox');
        const closeBtn = lightbox?.querySelector('.lightbox__close');

        function openLightbox() {
            lightbox?.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeLightbox() {
            lightbox?.classList.add('hidden');
            document.body.style.overflow = '';
        }

        img?.addEventListener('click', openLightbox);

        // 点击 lightbox 自身（backdrop）关闭（与 masks 一致：e.target === lightbox）
        lightbox?.addEventListener('click', (e) => {
            if (e.target === lightbox) closeLightbox();
        });

        closeBtn?.addEventListener('click', closeLightbox);

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && lightbox?.classList.contains('hidden') === false) {
                closeLightbox();
            }
        });
    </script>
</BaseLayout>